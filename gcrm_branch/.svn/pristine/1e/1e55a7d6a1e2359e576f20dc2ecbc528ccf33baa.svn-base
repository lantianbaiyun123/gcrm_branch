define(["app","../_services/http/Material","../_directives/ytJqueryFileUpload","../_directives/ytAjaxupload","../_directives/ytPlaceholder"],function(t){t.registerFactory("MaterialEditModal",["$modal","Material","STATIC_DIR",function(t,e,a){return{show:function(e,i){var l={title:"MATERIAL_EDIT"},n=t.open({templateUrl:a+"app/material/editModal.tpl.html",controller:"CtrlMaterialEdit",windowClass:"material-edit-modal",backdrop:"static",resolve:{opts:function(){return angular.extend(l,e)}}});n.result.then(function(t){"ok"===t.btnType&&i(t.response)})}}}]),t.registerController("CtrlMaterialEdit",["$scope","$log","$modalInstance","$filter","$q","Utils","Material","opts",function(t,e,a,i,l,n,r,o){function d(){var e=s(),a=!0,i=!0;return(1===~~t.adContentInfo.materialType||2===~~t.adContentInfo.materialType)&&(i=c()),(0===~~t.adContentInfo.materialType||2===~~t.adContentInfo.materialType)&&(a=p()),e&&i&&a}function s(){return t.checkingUrl=!0,!!t.editData.materialApply.materialUrl&&n.urlValidator(t.editData.materialApply.materialUrl)}function c(){return t.checkingTitle=!0,!!t.editData.materialApply.materialTitle}function p(){return t.checkingMaterialList=!0,!!t.editData.imageList.length}function m(){t.editData.codeFile.materialFileType="EMBED_CODE";for(var e=t.editData.imageList.length-1;e>=0;e--)t.editData.imageList[e].materialFileType="IMAGE";t.editData.materialApply.adSolutionContentId=t.adContentInfo.adContentId}t.title=o.title,t.adContentInfo=o.adContentInfo,t.editData={},t.editData.materialSaveType=o.saveType,t.editData.imageList=o.materialData.imageList||[],t.editData.codeFile=o.materialData.codeFile||{},t.editData.materialApply=o.materialData.materialApply||{},t.codeUploadOpts={uploadedText:i("translate")("MATERIAL_UPLOAD_CODE_FILE"),formatErrorText:"UPLOAD_FILE_TYPE_FORBIDDEN"},t.materialUploadOpts={uploadedText:i("translate")("MATERIAL_UPLOAD_MATERIAL"),formatErrorText:"UPLOAD_FILE_TYPE_FORBIDDEN"},t.beginUpload=function(){t.submitDisabled=!0},t.uploaded=function(){t.submitDisabled=!1},t.removeCodeFile=function(){t.editData.codeFile={}},t.removeMaterial=function(e){t.editData.imageList.splice(e,1)},t.cancel=function(){a.dismiss("cancel")},t.ok=function(){if(t.submitDisabled=!0,d()){m();var e=r.save(t.editData);e.success(function(t){200===t.code&&a.close({btnType:"ok",response:t})}),e["finally"](function(){t.submitDisabled=!1})}else t.submitDisabled=!1}}])});