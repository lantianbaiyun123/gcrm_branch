define(["app","../_services/Select2Suggest","../_services/http/Material","../_directives/ytPositionSelect","../_filters/DatePeriodFilter","anuglar-ui-select2"],function(e){e.registerController("CtrlMaterialList",["$scope","$log","$filter","PageSet","Material","MaterialListConstant","Select2Suggest","Modal",function(e,t,i,r,a,o,n,s){function l(){var t={},r="yyyy-MM-dd",a=e.qForm,o=e.pager;return t.pageSize=o.pageSize,t.pageNumber=o.pageNumber,t.advertiser=a.advertiser,t.queryType=a.queryType.type,t.queryString=a.queryString,t.beginThrowTime=i("date")(a.startTime,r),t.endThrowTime=i("date")(a.endTime,r),t.platformId=a.positionSelected.platform&&a.positionSelected.platform.id,t.siteId=a.positionSelected.site&&a.positionSelected.site.id,t.channelId=a.positionSelected.channel&&a.positionSelected.channel.id,t.areaId=a.positionSelected.area&&a.positionSelected.area.id,t.positionId=a.positionSelected.position&&a.positionSelected.position.id,t.customerId=a.customer&&a.customer.data,t}function c(){var i=l();a.getList(i).success(function(i){if(200===i.code)try{e.materialList=i.data.content,e.pager.totalCount=i.data.totalCount,e.pager.totalPages=i.data.totalPages}catch(r){t.info(i)}else t.info(i)})}function p(){e.pager.pageNumber=1}r.set({activeIndex:1,siteName:"materialList"}),e.queryMoreShow=!1,e.toggleQueryMore=function(){e.queryMoreShow=!e.queryMoreShow},e.qTypes=o.queryTypes,e.qForm={queryType:e.qTypes[0]},e.qForm.positionSelected={},e.materialList=[],e.advertiser=n.getCustomerOptionForAdOwner({allowClear:!0}),e.customer=n.getCustomerOption({placeholder:i("translate")("MATERIAL_INPUT_CUSTOMER"),allowClear:!0}),e.pager={pageSize:10,pageSizeSlots:[10,20,30,50],pageNumber:1,totalCount:0},e.setPageSize=function(t){e.pager.pageSize=t,p(),c()},e.$watch("pager.pageNumber",function(e){e&&c()}),e.btnQuery=function(){p(),c()},e.setQueryType=function(t){e.qForm.queryType=t},e.sendReminder=function(e){a.sendReminder({applyId:e}).success(function(e){200===e.code&&s.success({content:i("translate")("SUCCESS_REMIDER"),timeOut:3e3})})}}]),e.registerService("MaterialListConstant",["$filter",function(e){var t=e("translate");return{queryTypes:[{name:t("MATERIAL_AD_CONTENT_NUMBER"),type:"CONTENTID"},{name:t("MATERIAL_AD_SOLUTION_NUMBER"),type:"SOLUTIONID"},{name:t("MATERIAL_RESOURCE_POSITION_NUMBER"),type:"RESOURCEID"}]}}])});