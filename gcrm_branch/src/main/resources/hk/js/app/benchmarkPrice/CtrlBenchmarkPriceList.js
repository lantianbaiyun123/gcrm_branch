define(["app","../_common/ytCommon","../_services/PageSet","../_services/Select2Suggest","../_services/http/BenchmarkPrice","../_directives/ytPopoverConfirm","anuglar-ui-select2"],function(e){e.registerController("CtrlBenchmarkPriceList",["$scope","$log","$state","$filter","$timeout","PageSet","Modal","Select2Suggest","BenchmarkPrice",function(e,t,r,a,s,n,o,i,u){function c(){l()}function l(){var r=m();u.getList(r).success(function(r){if(200===r.code)try{e.priceList=r.data.result,e.pager.totalCount=r.data.totalCount,e.pager.totalPages=r.data.totalPages}catch(a){t.info(r)}else t.info(r)})}function m(){var t={},r="yyyy-MM-dd";return t.pageSize=e.pager.pageSize,t.pageNumber=e.pager.pageNumber,t.advertisingPlatformId=e.queryForm.platform.value,t.siteId=e.queryForm.siteArea.value,t.businessType=e.queryForm.businessType.value,t.approveStatus=e.queryForm.approvalStatus.value,t.status=e.queryForm.status.value,t.startDate=a("date")(e.queryForm.startDate,r),t.endDate=a("date")(e.queryForm.endDate,r),e.queryForm.operator&&(t.createOperator=e.queryForm.operator.value),t}function g(){e.pager.pageNumber=1}n.set({activeIndex:1,siteName:"benchmarkPriceList"}),e.selectAll={text:a("translate")("BENCHMARK_PRICE_SELECT_ALL"),value:""},e.msgs.listAlerts.length&&s(function(){e.msgs.listAlerts=[]},5e3),e.closeMsg=function(t){e.msgs.listAlerts.splice(t,1)},e.queryMoreShow=!1,e.toggleQueryMore=function(){e.queryMoreShow=!e.queryMoreShow},e.queryForm={platform:e.selectAll,siteArea:e.selectAll,status:e.selectAll,businessType:e.selectAll,approvalStatus:e.selectAll},e.$watch("queryForm.platform.value",function(t){e.constant&&(t?e.getSiteArea(t).then(function(t){e.constant.siteArea=t}):e.constant.siteArea=[],e.queryForm.siteArea=e.selectAll)}),e.changeQueryForm=function(t,r){e.queryForm[t]=r},e.submitter=i.getBenchmarkPriceSubmitter(),e.pager={pageSize:10,pageSizeSlots:[10,20,30,50],pageNumber:1,totalCount:0},e.setPageSize=function(t){e.pager.pageSize=t,g(),l()},e.priceList=[],e.btnQuery=function(){g(),l()},e.$watch("pager.pageNumber",function(e,t){e&&e!==t&&l()}),e.withdrawPrice=function(e){u.withdraw({quotationMainId:e}).success(function(e){200===e.code&&(l(),o.success({content:a("translate")("SUCCESS_WITHDRAW"),timeOut:2e3}))})},e.nullifyPrice=function(e){u.nullify({quotationMainId:e}).success(function(e){200===e.code&&(l(),o.success({content:a("translate")("SUCCESS_NULLITY"),timeOut:2e3}))})},e.sendReminder=function(e){u.sendReminder({quotationMainId:e}).success(function(e){200===e.code&&(l(),o.success({content:a("translate")("SUCCESS_REMIDER"),timeOut:2e3}))})},c()}])});