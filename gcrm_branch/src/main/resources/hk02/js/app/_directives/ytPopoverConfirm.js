define(["app"],function(o){o.registerDirective("ytPopoverConfirm",["$compile","$position","$parse","$log","$timeout","$filter","$document",function(o,e,t,i,n,r,p){return{restrict:"A",scope:{ytPopoverConfirm:"&",ytPopoverCancel:"&",ytPopoverBeforeShow:"&",ytPopoverMsg:"="},link:function(t,i,s){function a(){v.msg=t.ytPopoverMsg,v.title=s.ytPopoverTitle||d("ARE_YOU_SURE"),v.okText=s.ytPopoverOkText||d("CONFIRM"),v.okBtnClass=s.ytPopoverOkClass||"btn-primary"}function c(){v.position=u?e.offset(i):e.position(i),v.position.top=v.position.top-m.height(),v.position.left=v.position.left-(m.width()-e.position(i).width)/2}function l(o){v.isOpen&&o.target!==i[0]&&(v.isOpen=!1,i.removeAttr("disabled"),v.$$phase||v.$apply(),i.removeAttr("disabled"))}function f(o){o.preventDefault(),n(function(){if(!v.isOpen){var o=t.ytPopoverBeforeShow();(o||"undefined"==typeof o)&&(v.$apply(function(){v.isOpen=!0}),i.attr("disabled","disabled"))}},0)}var d=r("translate"),v=(i[0],t.$new()),u="true"===s.appendToBody?!0:!1;v.placement=s.ytPopoverPlacement||"top",v.title=s.ytPopoverTitle||d("ARE_YOU_SURE"),v.okText=s.ytPopoverOkText||d("CONFIRM"),v.okBtnClass=s.ytPopoverOkClass||"btn-primary",v.msg=t.ytPopoverMsg;var y=angular.element("<div yt-popover-wrap></div>"),m=o(y)(v);u?p.find("body").append(m):i.after(m),v.isOpen=!1,v.isGoodToOpen=!1;var P=!1,O=!1;v.$watch("isOpen",function(o){o?(a(),n(function(){c(),v.isGoodToOpen=!0}),p.bind("click",l),O&&i.unbind("click",f),P=!0):(P&&p.unbind("click",l),i.bind("click",f),O=!0,v.isGoodToOpen=!1)}),v.ok=function(){n(function(){v.isOpen=!1,t.ytPopoverConfirm(),i.removeAttr("disabled")})},v.cancel=function(){v.isOpen=!1,t.ytPopoverCancel(),i.removeAttr("disabled")},t.$on("$destroy",function(){m.remove(),v.$destroy()})}}}]),o.registerDirective("ytPopoverWrap",["STATIC_DIR",function(o){return{restrict:"EA",replace:!0,templateUrl:o+"app/_directives/ytPopoverConfirm.tpl.html",link:function(o,e){e.bind("click",function(o){o.preventDefault(),o.stopPropagation()})}}}])});