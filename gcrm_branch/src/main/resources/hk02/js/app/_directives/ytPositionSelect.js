define(["app"],function(e){e.registerDirective("ytPositionSelect",["$log","$filter","Position","STATIC_DIR",function(e,t,i,l){return{scope:{positionSelected:"=",ytPositionSelect:"="},restrict:"A",templateUrl:l+"app/_directives/ytPositionSelect.tpl.html",replace:!0,link:function(e){function l(){3===~~r.level&&delete e.q.position;for(var t in e.q)e.q[t].selected=angular.copy(e.q[t].all)}function a(t){for(var i=e.q[t];i&&i.next;)i=e.q[i.next],i&&(i.list=[],i.selected=angular.copy(i.all))}function n(t){switch(t){case"platform":var l;l=r.byRole?i.getSiteListByRole({adPlatformId:e.q[t].selected.id}):i.getSiteList4Radio({productId:e.q[t].selected.id}),l.success(function(t){200===t.code&&(e.q.site.list=t.data||[],e.q.site.list.unshift(e.q.site.all))});break;case"site":var a;a=r.byRole?i.getChannelListByRole({productId:e.q.platform.selected.id,siteId:e.q[t].selected.id}):i.getChannelList({productId:e.q.platform.selected.id,siteId:e.q[t].selected.id}),a.success(function(t){200===t.code&&(e.q.channel.list=t.data||[],e.q.channel.list.unshift(e.q.channel.all))});break;case"channel":var n;n=r.byRole?i.getParentByRole({parentId:e.q[t].selected.id}):i.getAreaList({parentId:e.q[t].selected.id}),n.success(function(t){200===t.code&&(e.q.area.list=t.data||[],e.q.area.list.unshift(e.q.area.all))});break;case"area":var s;s=r.byRole?i.getParentByRole({parentId:e.q[t].selected.id}):i.getPositionList({parentId:e.q[t].selected.id}),s.success(function(t){200===t.code&&e.q.position&&(e.q.position.list=t.data||[],e.q.position.list.unshift(e.q.position.all))})}}function s(){var t={};for(var i in e.q)t[i]=angular.copy(e.q[i].selected);return t}var o,c={level:4},r=angular.extend(c,e.ytPositionSelect);o=r.byRole?i.getPlatformListByRole():i.getPlatformList4Radio(),o.success(function(t){if(200===t.code){var i=angular.copy(t.data)||[];i.unshift(e.q.platform.all),e.q.platform.list=i}e.positionSelected=s()}),e.setChoice=function(t,i){a(i);var l=e.q[i].list[t];e.q[i].selected=l,l.id?n(i):e.q[i].pre,e.positionSelected=s()};var d=t("translate");e.q={platform:{all:{i18nName:d("POSITION_SELECT_ALL_PLATFORM"),id:void 0},list:[],next:"site"},site:{all:{i18nName:d("POSITION_SELECT_ALL_SITE"),id:void 0},list:[],next:"channel",pre:"platform"},channel:{all:{i18nName:d("POSITION_SELECT_ALL_CHANNEL"),id:void 0},list:[],next:"area",pre:"site"},area:{all:{i18nName:d("POSITION_SELECT_ALL_AREA"),id:void 0},list:[],next:"position",pre:"channel"},position:{all:{i18nName:d("POSITION_SELECT_ALL_POSITION"),id:void 0},list:[],pre:"area"}},e.notSorted=function(e){return e?Object.keys(e):[]},l()}}}])});