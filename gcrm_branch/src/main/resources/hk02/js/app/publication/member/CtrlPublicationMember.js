define(["app","../../_services/Select2Suggest","anuglar-ui-select2"],function(e){e.registerController("CtrlPublicationMember",["$scope","$log","$filter","PageSet","Publication","$modal","Modal","STATIC_DIR",function(e,t,c,n,s,o,i,r){n.set({activeIndex:4,siteName:"publicationMember"}),e.t={},s.getAvailablePlatform().success(function(t){200===t.code&&(e.t.platformList=t.data)}),e.changePlatform=function(t){s.getMemberList({platformId:t.id}).success(function(t){200===t.code&&(e.list=t.data)})},e.removeUser=function(e,t,n){s.removeMember({id:t.id,ucid:e.ucid}).success(function(e){200===e.code&&(i.success({content:c("translate")("SUCCESS_PUBLICATION_REMOVE_MEMBER")}),t.user.splice(n,1))})},e.addMember=function(e){var t=o.open({templateUrl:r+"app/publication/member/add.tpl.html",controller:["$scope","opts","Select2Suggest","$timeout","$modalInstance","$log",function(e,t,c,n,o,i){i.info(t,e),e.e={},e.e.users=[],e.e.userOption=c.getUserOption({onSelect:function(t){n(function(){e.e.users.push(t)})}}),e.ok=function(){s.addMember({id:t.rowData.id,channelId:t.rowData.channelId,ucid:e.e.user.ucid}).success(function(t){200===t.code&&o.close({user:e.e.user,recordId:t.data})})},e.cancel=function(){o.dismiss("cancel")}}],resolve:{opts:function(){return{rowData:e}}}});t.result.then(function(t){t&&(i.success({content:c("translate")("SUCCESS_PUBLICATION_ADD_MEMBER")}),e.id=t.recordId,e.user=e.user||[],e.user.push(t.user))})}}])});